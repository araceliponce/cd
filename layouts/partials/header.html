<header class="header">

  <style>
    input,
    textarea {
      caret-color: goldenrod;
    }

    .orange {
      /* background-color: var(--orange); */
    }

    .green {
      background-color: var(--green);
    }

    .flex {
      display: flex;
      gap: var(--gap, .5rem);
    }

    .header {
      padding: 0.7em;

      position: fixed;
      background-color: var(--header-bg);
      color: var(--header-color);
      top: 0;
      left: 0;
      right: 0;
      /* z-index: 7; */
      transition: all .2s ease;
    }

    .header+* {
      padding-top: 6rem;
    }

    .header-inner {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }

    .hidden-header .header {
      transform: translateY(-100%);
    }

    .hidden-header .sidebar--left {
      top: 1rem;
    }

    .header svg {
      width: 1em;
      height: 1em;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logo img {
      border-radius: 0.4rem;
      overflow: hidden;
    }

    .search {
      display: flex;
      width: min(40vw, 30rem);
      border-radius: .5rem;
      outline: 1px solid currentColor;
    }

    .search:focus-within {
      outline-color: rgba(218, 165, 32, 0.5);
      outline-width: 3px;
    }

    .search>* {
      width: 100%;
    }

    input#search__text {
      background-color: transparent;
      outline: none;
      padding: 0 0.5rem;
      width: 90%;
    }

    .on-right,
    .on-left {
      position: absolute;
      right: 0;
      top: 0;
      padding: .3rem;
    }

    .on-left {
      left: 0;
      right: auto;
    }

    #search__suggestions {
      background: var(--text);
      color: var(--background);
      border-radius: 0.2rem;

      position: absolute;
      width: 95vw;
      z-index: 1000;

      /* centrado */
      position: absolute;
      width: 95vw;
      z-index: 1000;
      transform: translate(-50%, 0%);
      left: 50%;
      /* 100% es justo debajo del contenedor */
      top: 90%;
    }

    @media (min-width: 768px) {
      .search {
        position: relative;
      }

      #search__suggestions {
        width: 60vw;
      }
    }

    .search__suggestions--hidden {
      display: none;
    }

    .search__suggestion-item {
      border-bottom: 1px dashed var(--accent);
      display: grid;
      grid-template-columns: 1fr 2fr;

      &:hover {
        mix-blend-mode: lighten;
      }
    }

    .search__suggestion-title,
    .search__suggestion-description {
      padding: 0 1rem;
      margin: 1rem 0;
    }

    .search__suggestion-title {
      font-weight: 700;
    }

    .search__suggestion-description {
      /* border-left: 1px solid var(--bg2); */
    }

    .search__no-results {
      padding: 0.75rem;
    }
  </style>
  <style>
    .header a,
    .header button {
      color: currentColor;
      text-decoration: none;
    }


    .header button>span,
    .header button>svg {
      pointer-events: none;
    }
  </style>

  <div class="header-inner limited">

    <a class="logo " href="
    {{- with $.Site.Params.Logo.URL -}}
      {{- . -}}
    {{- else -}}
      {{- $.Site.BaseURL -}}
    {{- end -}}">
      {{ with $.Site.Params.Logo.Text }}
      <img class="" src="/favicon-32x32.png" alt="" srcset="">
      <span class="d-none d-md-block">{{ . }}</span>
      {{ end }}
    </a>

    <div class="search">

      <div class="relative">
        <label for="search_text" class="sr-only">{{- $.Site.Params.search -}}</label>
        <input id="search__text" type="search" aria-label="{{- $.Site.Params.search -}}" autocomplete="off" />
        <div class="on-right d-none d-md-block"> {{ partial "i_lens.html"}}</div>
      </div>
      <div id="search__suggestions" class="search__suggestions--hidden"></div>
    </div>



    <div class="flex">
      <button class="theme__toggle light--hidden" aria-label="Toggle light mode">
        {{ partial "i_moon.html"}}
      </button>

      <button class="theme__toggle dark--hidden" aria-label="Toggle dark mode">
        {{ partial "i_sun.html"}}
      </button>

      <button id="btn" data-effect="st-effect-1" aria-label="Mostrar sidebar de navegaciÃ³n">
        <svg aria-hidden="true" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
          <rect width="18" height="1.5" fill=red ry="0.75" x="3" y="6.25" />
          <rect width="18" height="1.5" fill=red ry="0.75" x="3" y="11.25" />
          <rect width="18" height="1.5" fill=red ry="0.75" x="3" y="16.25" />
        </svg>
      </button>

    </div>
  </div>

  <style>
    header button {
      width: 2.5rem;
      aspect-ratio: 1;
      display: grid;
      place-items: center;
      border-radius: 50%;
      background: transparent;
      transition: background 0.2s;

      &:hover,
      &:focus-visible {
        background-color: var(--text);
      }

    }

    #btn:is(:focus-visible) {
      outline-color: var(--accent);
      outline-offset: .5rem;
      outline-width: 4px;
    }

    #btn svg:first-of-type {
      width: 65%;
      pointer-events: none;
    }

    #btn rect {
      transform-box: fill-box;
      transform-origin: 50% 50%;
      fill: currentColor;
    }

    .unset rect {
      transform-box: unset;
    }

    [aria-pressed=true] rect {
      /* transition: translate 0.2s, rotate 0.2s 0.3s; */
      transition: translate 0.15s, rotate 0.15s 0.25s;
    }

    rect {
      /* transition: rotate 0.2s 0s, translate 0.2s 0.2s; */
      transition: rotate 0.15s 0s, translate 0.15s 0.15s;
    }

    [aria-pressed=true] rect:nth-of-type(1) {
      translate: 0 333%;
      rotate: -45deg;
    }

    [aria-pressed=true] rect:nth-of-type(2) {
      rotate: 45deg;
    }

    [aria-pressed=true] rect:nth-of-type(3) {
      translate: 0 -333%;
      rotate: 45deg;
    }

    [aria-pressed=true] svg {
      rotate: 90deg;
      /* transition: rotate 1s 0.4s; */
      transition: rotate 0.7s 0.3s;
    }

    @supports (--custom: linear()) {
      :root {
        --elastic-out: linear(0, 0.2178 2.1%, 1.1144 8.49%,
            1.2959 10.7%, 1.3463 11.81%,
            1.3705 12.94%, 1.3726, 1.3643 14.48%,
            1.3151 16.2%, 1.0317 21.81%,
            0.941 24.01%, 0.8912 25.91%,
            0.8694 27.84%, 0.8698 29.21%,
            0.8824 30.71%, 1.0122 38.33%, 1.0357,
            1.046 42.71%, 1.0416 45.7%,
            0.9961 53.26%, 0.9839 57.54%,
            0.9853 60.71%, 1.0012 68.14%,
            1.0056 72.24%, 0.9981 86.66%, 1);
        --elastic-in-out: linear(0, 0.0009 8.51%, -0.0047 19.22%,
            0.0016 22.39%, 0.023 27.81%,
            0.0237 30.08%, 0.0144 31.81%,
            -0.0051 33.48%, -0.1116 39.25%,
            -0.1181 40.59%, -0.1058 41.79%, -0.0455,
            0.0701 45.34%, 0.9702 55.19%,
            1.0696 56.97%, 1.0987 57.88%,
            1.1146 58.82%, 1.1181 59.83%,
            1.1092 60.95%, 1.0057 66.48%,
            0.986 68.14%, 0.9765 69.84%,
            0.9769 72.16%, 0.9984 77.61%,
            1.0047 80.79%, 0.9991 91.48%, 1);
      }

      [aria-pressed=true] svg {
        transition-timing-function: var(--elastic-out);
      }
    }
  </style>

  <script>
    const btns = document.querySelectorAll('[data-effect]');
    const stContainer = document.querySelector('#st-container');
    const pusher = document.querySelector('.st-pusher');
    let effect;

    var header = document.querySelector("header");
    var body = document.body
    var navbarHeight = header.offsetHeight;
    var lastScrollTop = 0;

    window.onscroll = function () { scrollHide() };

    function scrollHide() {
      var st = window.pageYOffset || document.documentElement.scrollTop;
      // console.log(st);
      if (st > lastScrollTop) {
        body.classList.add('hidden-header');
      } else {
        body.classList.remove('hidden-header');
      }
      lastScrollTop = st <= 0 ? 0 : st;
    }


    // Abre el menu
    btns.forEach(btn => {
      btn.addEventListener('click', (e) => {

        // Gets the value of the data-effect attribute
        e = event
        effect = e.target.getAttribute('data-effect');

        // Applies it to the stContainer
        stContainer.classList.toggle(effect);
        stContainer.classList.toggle('st-menu-open');

        // Changes the atribute aria-pressed of the btn
        btn.setAttribute('aria-pressed', btn.matches('[aria-pressed=true]') ? false : true)
      })
    })
  </script>

</header>